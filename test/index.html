<html>
	<head>
		<meta charset="utf-8" />
		
		<title>Test</title>

		<script src="js/steganos.js"></script>
		<script src="js/image.js"></script>
		<script>
		var image;
		function encode(){
			try {
				var text = document.getElementById("box").value;
				image.chunks.test = steganos.stringToBytes(text);
				image.write();
				var dataUri = image.getDataUri();
				console.log(dataUri);
				document.getElementById("image").src = dataUri;
			}catch(err){
				alert(err);
			}
		}
		function decode(){
			try {
				image.read();
				console.log(image.chunks);
				alert(steganos.bytesToString(image.chunks.test));
			}catch(err){
				alert(err);
			}
		}
		function load(){
			console.log("d");
			var url = document.getElementById("url").value;
			
		  	var img = new Image();
		  	console.log("Loading image");
		  	img.src = url;
		  	img.onload = function(){
		  		console.log("Loaded");
			    try{
				    image = new steganos.Image(img);
				    image.allocChunk("test", []);
			    }catch(err){
			    	alert(err);
			    }
		  	};
		}
		</script>
	</head>

	<body>
		<div>
			<header>
				<h1>steganos test</h1>
			</header>

			<input type="text" id="url" value="test.png" /> <br/> 
			<a onclick="load()">Load</a><br/>
			<input type="text" id="box" value="encrypted" /> <br />	


			<a onclick="encode()">Encode</a> <a onclick="decode()">Decode</a>
			<br/><br/>
			Image (right click to save): 
			<img id="image" />
		</div>
	</body>
</html>
